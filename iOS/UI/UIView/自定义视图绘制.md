# 自定义视图绘制

**2D绘图一般可以拆分成一下几个操作**

- 线条
- 路径（填充或轮廓形状）
- 文本
- 图片
- 渐变

### 通过UIKit绘图
> 大部分自定义视图只能使用Core Graphics绘制，UIKit 不能绘制任意形状

```
- (void)drawRect:(CGRect)rect
{
    [[UIColor redColor] setFill];        // 设置填充颜色
    [[UIColor greenColor] setStroke];    // 设置描边颜色
    
    UIRectFill(rect);                // 填充矩形
    UIRectFrame(rect);               // 给矩形描边
}


// 在UIGraphics.h 提供了简单方法绘制视图
#include "UIGraphics.h"

UIKIT_EXTERN void UIRectFillUsingBlendMode(CGRect rect, CGBlendMode blendMode);
UIKIT_EXTERN void UIRectFill(CGRect rect);   // 填充矩形区域

UIKIT_EXTERN void UIRectFrameUsingBlendMode(CGRect rect, CGBlendMode blendMode);
UIKIT_EXTERN void UIRectFrame(CGRect rect);   // 给矩形区域描边

UIKIT_EXTERN void UIRectClip(CGRect rect);

```

> 系统会提供一个**图形上下文（Graphics Context）**，这个上下文保存了包括画笔颜色，填充颜色，文本颜色，字体，形状等大量信息。可以通过`UIGraphicsGetCurrentContext()`获取

```
#include "UIGraphics.h"

UIKIT_EXTERN CGContextRef __nullable UIGraphicsGetCurrentContext(void) CF_RETURNS_NOT_RETAINED;
UIKIT_EXTERN void UIGraphicsPushContext(CGContextRef context);
UIKIT_EXTERN void UIGraphicsPopContext(void);
```

## 路径 （UIBezierPath）
> UIBezierPath(贝塞尔曲线) 可以绘制任何曲线和线条
> 并且提供了方法绘制常用的线条，弧线，矩形，圆角矩形，圆，椭圆等

```
#include "UIBezierPath"

- (void)drawRect:(CGRect)rect
{
    CGSize size = self.bounds.size;
    CGFloat margin  = 10;
    CGFloat radius = rintf(MIN(size.height - margin, size.width - margin) / 4);
    
    CGFloat xOffset,yOffSet;
    
    /**
     * 使用rintf(四舍五入)可以确保点对其，即像素对齐，可以改善性能并避免边缘模糊
     **/
    CGFloat tmpOffset = rintf((size.height - size.width) / 2);
    
    if(tmpOffset > 0)
    {
        xOffset = rintf(margin / 2);
        yOffSet = tmpOffset;
    }
    else
    {
        xOffset = -tmpOffset;
        yOffSet = rintf(margin / 2);
    }
    
    [[UIColor redColor] setFill];       // 设置填充颜色
    [[UIColor greenColor] setStroke];   // 设置描边颜色
    
    // 绘制路径
    UIBezierPath * path = [UIBezierPath bezierPath];
    
    [path addArcWithCenter:CGPointMake(xOffset + radius, yOffSet + 2 * radius)
                    radius:radius
                    startAngle: M_PI_2
                      endAngle: - M_PI_2
                 clockwise:YES];
    
    [path addArcWithCenter:CGPointMake(xOffset + 2 * radius, yOffSet +  radius)
                    radius:radius
                startAngle: - M_PI
                  endAngle: 0
                 clockwise:YES];
    
    [path addArcWithCenter:CGPointMake(xOffset + 3 * radius, yOffSet + 2 * radius)
                    radius:radius
                startAngle:  - M_PI_2
                  endAngle:  M_PI_2
                 clockwise:YES];
    
    [path addArcWithCenter:CGPointMake(xOffset + 2 * radius, yOffSet + 3 * radius)
                    radius:radius
                startAngle:0
                  endAngle:- M_PI
                 clockwise:YES];
    
    [path closePath];   // 将当前point与起始point连接在一起
    
    [path fill];     // 填充颜色
    [path stroke];   // 描边

}

```





